/**
 * Think商城首页轮播图js
 * @author 付润鑫
 * @date 2015-10-17
 **/

$(function() {
	var banner_img = $(".banner_img");
	var banner_li = $(".banner_img").find("li");
	var banner_bt = $(".banner_bt");
	var banner_length = banner_li.length;
	//parseInt($("#TitleLoopTime").html() + '000');//循环播放间隔
	var timer = 5000; 
	var ban = 0;
	banner_li.eq(ban).show();

	for ( var i = 0; i < banner_length; i++) {
		banner_bt.append($("<a></a>"));

	}
	banner_bt.find("a").eq(ban).addClass("now");
	banner_img.hover(function() {
		clearInterval(play);
	}, function() {
		play = setInterval(banner_next, timer);
	});
	$(".banner_prev").click(banner_prev);
	$(".banner_next").click(banner_next);

	function banner_prev() {
		ban--;
		if (ban < 0) {
			ban = banner_length - 1;
		}
		banner_li.fadeOut(500);
		banner_bt.find("a").removeClass("now");
		banner_bt.find("a").eq(ban).addClass("now");
		banner_li.eq(ban).fadeIn(500);
	}
	function banner_next() {
		ban++;
		banner_li.fadeOut(500);
		if (ban == banner_length) {
			ban = 0;
		}
		banner_bt.find("a").removeClass("now");
		banner_bt.find("a").eq(ban).addClass("now");
		banner_li.eq(ban).fadeIn(500);
	}
	$(".banner_bt a").hover(function() {
		var banner_bt_index = $(this).index();
		clearInterval(play);
		banner_bt.find("a").removeClass("now");
		banner_bt.find("a").eq(banner_bt_index).addClass("now");
		banner_li.fadeOut(0);
		banner_li.eq(banner_bt_index).fadeIn(0);
		play = setInterval(banner_next, timer);
	});
	var play = setInterval(banner_next, timer);
	$("#think_banner").hover(function() {
		$(".banner_prev").stop().fadeIn(0);
		$(".banner_next").fadeIn(0);
	}, function() {
		$(".banner_prev").stop().fadeOut(0);
		$(".banner_next").stop().fadeOut(0);
	});
});
$(function(){

	//调用之前先动态生成li相关信息
	//piece中想成为锚点的元素大概长这样子：<div id="a" class="maodian" _title="电脑" style="height:700px;background:yellow;"></div>

	var $shop_floornav = $('#shop_floornav');
	$('.maodian').each(function(index){
		var id = $(this).attr('id');
		var _title = $(this).attr('_title');
		if(!id){
			console.log('有锚点没有设置id属性~!');
		}
		$shop_floornav.append('<a href="#'+id+'" data-scroll="#'+id+'" title="'+_title+'">'+(index-0+1)+'F</a>');
	});

    // 右侧浮动栏
    Shop.floornav();
});
/**
 * Think商城首页分类导航js
 * @author 付润鑫
 * @date 2015-10-17
 **/

$(function(){
    var navItem=$('.shop_nav_item');
    var childItem=$('.nav_child_item');
    navItem.hover(function(){
        $(this).find('.shop_nav_link').addClass('active').siblings('.shop_nav_child').show();

        var child=$(this).find('.shop_nav_child');
        var childH=child.height();

        if(childH<=300){
            child.css('height','300px');
        }else{
            child.css('height',childH+'px');
        }

    },function(){
        $(this).find('.shop_nav_link').removeClass('active').siblings('.shop_nav_child').hide();
    });

    childItem.hover(function(){
        $(this).find('.nav_child_link').addClass('active').siblings('.shop_nav_children').show();

        var children=$(this).find('.shop_nav_children');
        var childredH=children.height();

        if(childredH<=300){
            children.css('height','300px');
        }else{
            children.css('height',childredH+'px');
        }

    },function(){
        $(this).find('.nav_child_link').removeClass('active').siblings('.shop_nav_children').hide();
    });	
});
/**
 * Think商城首页商城快报js
 * @author 付润鑫
 * @date 2015-10-17
 **/
$(function() {
	function AutoScroll(obj) {
		$(obj).find("ul:first").animate({
			marginTop : "-26px"
		}, 500, function() {
			$(this).css({
				marginTop : "0px"
			}).find("li:first").appendTo(this);
		});
	}

	var timerNews = null;
	timerNews = setInterval(function() {
		AutoScroll('#shop_news');
	}, 2000);

	$('#shop_news').hover(function() {
		clearInterval(timerNews);
	}, function() {
		timerNews = setInterval(function() {
			AutoScroll('#shop_news');
		}, 2000);
	});
});
/**
 * Think商城首页右侧浮动栏js
 * @author 付润鑫
 * @date 2015-10-17
 **/

$(function() {
	$('.shop_pointer').hover(function() {
		$(this).addClass('active').find('.V_jt,.V_icon_cont').show();
	}, function() {
		$(this).removeClass('active').find('.V_jt,.V_icon_cont').hide();
	});

	$('#shop_totop').click(function() {
		$('html,body').animate({
			scrollTop : 0
		}, 500);
	});

	$(window).scroll(function() {
		var scrollTop = $(window).scrollTop();
		var winHeight = $(window).height();
		if (scrollTop < 74) {
			$('#shop_rightbar').css({
				'height' : (winHeight - (74 - scrollTop)) + 'px',
				'top' : (74 - scrollTop) + 'px'
			});
		} else {
			$('#shop_rightbar').css({
				'height' : winHeight + 'px',
				'top' : '0px'
			});
		}
	});

});